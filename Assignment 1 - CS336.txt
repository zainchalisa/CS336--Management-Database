# Zain Chalisa (zc285)
# CS366

# 1.Drinkers who like the most beers (highest number of beers)

Select distinct drinker, count(beer) From Likes GROUP BY drinker ORDER BY Count(*) desc;

'Mike','9'
'John','8'
'Yuhan','5'
'Gunjan','4'
'Justin','2'
'Sahil','2'
'Joe','1'
'Jesse','1'
'Devarsh','1'
'Vince','1'

# 2. Bars which sell most expensive Budweiser and are not frequented by Gunjan

Select distinct s.bar FROM Sells s JOIN Frequents, (Select MAX(price) as LargestPrice FROM Sells)sl 
WHERE s.beer = 'Budweiser' and Frequents.drinker != 'Gunjan' and s.price = LargestPrice;

Caravan

# 3. Drinkers who frequent only bars which serve all beers they like

Interpretation: Only drinkers who like all the beers every bar they frequent sells (this should not include the drinkers who do not like any beer or do not frequent any bars)

Select distinct drinker FROM Likes l1 WHERE drinker NOT IN
	(Select l2.drinker FROM Likes l2 WHERE NOT EXISTS 
    (Select distinct Frequents.bar FROM Sells left join Frequents on Sells.bar = Frequents.bar WHERE Frequents.bar = Sells.bar and Sells.beer = l2.beer AND Frequents.drinker = l2.drinker));

Jesse

        
# 4. Drinkers who frequent most popular bar (the one with highest count of drinkers)

Select distinct drinker FROM Frequents, (Select bar FROM Frequents GROUP BY bar ORDER BY count(bar) desc LIMIT 1)bc 
WHERE Frequents.bar = bc.bar;  

'Bob'
'Erik'
'Herb'
'Jesse'
'Joe'
'John'
'Justin'
'Mike'
'Rebecca'
'Tom'
'Vince'
'Jeanie'
'Tatiana'
'Yuhan'


# 5. Precinct(s) which collected the least number of  total votes by end of day of November 5th 2020

Interpretation: Provide the top 5 precincts with the least number of total votes by the end of the day November 5th 2020

Select distinct precinct, sum(totalvotes) FROM Penna 
WHERE timestamp like '2020-11-05%' 
GROUP BY precinct ORDER BY sum(totalvotes) asc LIMIT 5; 
 
Franconia 2
Green Hills Voting Precinct
14-06
Lower Merion 12-3
16-08


# 6. Which precincts did Trump win by more than 100 votes in 2020 

Select distinct precinct, max(timestamp) FROM Penna 
WHERE timestamp = (select Max(timestamp) from Penna)
GROUP BY precinct HAVING sum(Trump) - sum(Biden) > 100;


'Adams Township - Dunlo Voting Precinct'
'Adams Township - Elton Voting Precinct'
'Adams Township - St. Michael Voting Precinct'
'Adams Township No. 1 Voting Precinct'
'Adams Township- - Gramlingtown Voting Precinct'
'Allegheny Township Voting Precinct'
'Barr Township Voting Precinct'
'Blacklick Township Voting Precinct'
'Cambria Township - Colver Voting Precinct'
'Cambria Township - Revloc Voting Precinct'
'Cambria Township No. 1 Voting Precinct'
'Cambria Township No. 4 Voting Precinct'
'Carrolltown Borough Voting Precinct'
'Chest Township Voting Precinct'
'Clearfield Township Voting Precinct'
'Conemaugh Township - Center Voting Precinct'
'Conemaugh Township - Cover Hil Voting Precinct'
'Cresson Borough Voting Precinct'
'Cresson Township - North Voting Precinct'
'Cresson Township - South Voting Precinct'
'Croyle Township - No. 2 Voting Precinct'
'Croyle Township No. 1 Voting Precinct'
'Daisytown Borough Voting Precinct'
'Dean Township Voting Precinct'
'East Carroll Township - South Voting Precinct'
'East Conemaugh Borough Voting Precinct'
'East Taylor Township - No. 1 Voting Precinct'
'East Taylor Township No. 2 Voting Precinct'
'Ebensburg Borough - Center Voting Precinct'
'Ebensburg Borough - East Voting Precinct'
'Ebensburg Borough - West Voting Precinct'
'Elder Township Voting Precinct'
'Ferndale Borough Voting Precinct'
'Gallitzin Borough Voting Precinct'
'Gallitzin Township Voting Precinct'
'Geistown Borough No. 1 Voting Precinct'
'Geistown Borough No. 2 Voting Precinct'
'Hastings Borough Voting Precinct'
'Jackson Township - Vinco Voting Precinct'
'Jackson Township No. 1 Voting Precinct'
'Jackson Township No.3 Voting Precinct'
'Johnstown - Eighth Ward No. 3 Voting Precinct'
'Lilly Borough - Second Ward Voting Precinct'
'Lorain Borough Voting Precinct'
'Lower Yoder Township No. 2 Voting Precinct'
'Lower Yoder Township No.1 Voting Precinct'
'Middle Taylor Township Voting Precinct'
'Munster Township Voting Precinct'
'Nanty Glo Borough - First Ward Voting Precinct'
'Nanty Glo Borough - Second War Voting Precinct'
'Northern Cambria Borough - Cen Voting Precinct'
'Northern Cambria Borough - Nor Voting Precinct'
'Northern Cambria Borough - Sou Voting Precinct'
'Patton Borough - First Ward Voting Precinct'
'Patton Borough - Second Ward Voting Precinct'
'Portage Borough - Second Ward Voting Precinct'
'Portage Borough - Third Ward Voting Precinct'
'Portage Township - Southwest Voting Precinct'
'Portage Township Center Voting Precinct'
'Reade Township Voting Precinct'
'Richland Township No. 1 Voting Precinct'
'Richland Township No. 2 Voting Precinct'
'Richland Township No. 3 Voting Precinct'
'Richland Township No. 4 Voting Precinct'
'Richland Township No. 5 Voting Precinct'
'Richland Township No. 6 Voting Precinct'
'Richland Township No. 7 Voting Precinct'
'Richland Township No. 8 Voting Precinct'
'Richland Township No. 9 Voting Precinct'
'Sankertown Borough Voting Precinct'
'Scalp Level Borough Voting Precinct'
'South Fork Borough Voting Precinct'
'Southmont Borough No. 1 Voting Precinct'
'Stonycreek Township - Ward 1 Voting Precinct'
'Stonycreek Township - Ward 3 Voting Precinct'
'Stonycreek Township - Ward 4 Voting Precinct'
'Summerhill Borough Voting Precinct'
'Summerhill Township - North Voting Precinct'
'Summerhill Township - South Voting Precinct'
'Susquehanna Township - North Voting Precinct'
'Susquehanna Township - South Voting Precinct'
'Upper Yoder Township No. 1 Voting Precinct'
'Upper Yoder Township No. 2 Voting Precinct'
'Upper Yoder Township No. 3 Voting Precinct'
'Upper Yoder Township No. 4 Voting Precinct'
'Vintondale Borough Voting Precinct'
'Washington Township Voting Precinct'
'West Carroll Township - North Voting Precinct'
'West Carroll Township - South Voting Precinct'
'West Taylor Township Voting Precinct'
'Westmont Borough No. 1 Voting Precinct'
'Westmont Borough No. 2 Voting Precinct'
'Westmont Borough No. 3 Voting Precinct'
'White Township Voting Precinct'
'BENNER NORTH'
'BENNER SOUTH'
'BOGGS EAST'
'BOGGS WEST'
'BURNSIDE'
'CENTRE HALL'
'CURTIN SOUTH'
'FERGUSON WEST'
'GREGG'
'HAINES'
'HOWARD BORO'
'HOWARD TWP'
'HUSTON'
'LIBERTY'
'MARION'
'MILES EAST'
'MILESBURG'
'MILLHEIM'
'PENN'
'PORT MATILDA'
'POTTER NORTH'
'POTTER SOUTH'
'RUSH NORTH'
'RUSH SOUTH'
'RUSH WEST'
'SNOW SHOE'
'SNOW SHOE EAST'
'SNOW SHOE WEST'
'SPRING EAST'
'SPRING NORTH'
'SPRING SOUTH'
'SPRING SOUTHWEST'
'SPRING WEST'
'TAYLOR'
'UNION'
'WALKER EAST'
'WALKER WEST'
'WORTH'
'043 W BRANDYWINE W'
'060 W CALN 1'
'061 W CALN 2'
'165 E COVENTRY 2'
'215 ELK'
'220 ELVERSON'
'235 W FALLOWFIELD'
'290 HIGHLAND'
'295 HONEY BROOK BORO'
'300 HONEYBROOK TWP 1'
'301 HONEYBROOK TWP 2'
'335 LONDONDERRY'
'380 W NANTMEAL'
'405 EAST NOTTINGHAM EAST'
'406 EAST NOTTINGHAM WEST'
'410 W NOTTINGHAM'
'430 LOWER OXFORD W'
'435 UPPER OXFORD'
'545 W SADSBURY'
'705 WARWICK W'
'BERRYSBURG BOROUGH'
'CONEWAGO TWP--1ST PRECINCT'
'CONEWAGO TWP--2ND PRECINCT'
'DERRY TOWNSHIP--10TH PRECINCT'
'DERRY TOWNSHIP--6TH PRECINCT'
'EAST HANOVER TOWNSHIP--1ST PRECINCT'
'EAST HANOVER TOWNSHIP--2ND PRECINCT'
'ELIZABETHVILLE BOROUGH'
'GRATZ BOROUGH'
'HALIFAX BOROUGH'
'HALIFAX TWP--1ST PRECINCT'
'HALIFAX TWP--2ND PRECINCT'
'HUMMELSTOWN--2ND PRECINCT'
'JACKSON TOWNSHIP'
'JEFFERSON TOWNSHIP'
'LONDONDERRY TWP--1ST PRECINCT'
'LONDONDERRY TWP--2ND PRECINCT'
'LONDONDERRY TWP--3RD PRECINCT'
'LOWER PAXTON TWP--16TH PRECINCT'
'LOWER PAXTON TWP--22ND PRECINCT'
'LOWER PAXTON TWP--3RD PRECINCT'
'LOWER PAXTON TWP--4TH PRECINCT'
'LOWER PAXTON TWP--9TH PRECINCT'
'LOWER SWATARA TWP--1ST PRECINCT'
'LOWER SWATARA TWP--2ND PRECINCT'
'LOWER SWATARA TWP--4TH PRECINCT'
'LYKENS BOROUGH--1ST WARD'
'LYKENS BOROUGH--2ND WARD'
'LYKENS TOWNSHIP'
'MIDDLE PAXTON TWP--1ST PRECINCT'
'MIDDLE PAXTON TWP--2ND PRECINCT'
'MIDDLE PAXTON TWP--3RD PRECINCT'
'MIDDLETOWN--3RD WARD, 2ND PRECINCT'
'MIFFLIN TOWNSHIP'
'MILLERSBURG BOROUGH'
'RUSH TOWNSHIP'
'SOUTH HANOVER TWP--1ST PRECINCT'
'UPPER PAXTON TWP--1ST PRECINCT'
'UPPER PAXTON TWP--2ND PRECINCT'
'WASHINGTON TOWNSHIP'
'WAYNE TOWNSHIP'
'WEST HANOVER TWP--1ST PRECINCT'
'WEST HANOVER TWP--2ND PRECINCT'
'WEST HANOVER TWP--3RD PRECINCT'
'WEST HANOVER TWP--4TH PRECINCT'
'WEST HANOVER TWP--5TH PRECINCT'
'WEST HANOVER TWP--7TH PRECINCT'
'WICONISCO TWP--1ST PRECINCT'
'WICONISCO TWP--2ND PRECINCT'
'WILLIAMS TWP'
'WILLIAMSTOWN--1ST WARD'
'WILLIAMSTOWN--2ND WARD'
'Aleppo Voting Precinct'
'Carmichaels Borough Voting Precinct'
'Center Voting Precinct'
'Cumberland #1 Voting Precinct'
'Cumberland #2 Voting Precinct'
'Cumberland #4 Voting Precinct'
'Cumberland Nemacolin Voting Precinct'
'Dunkard #1 Voting Precinct'
'Dunkard #2 Voting Precinct'
'Franklin East Voting Precinct'
'Franklin North Voting Precinct'
'Franklin South Voting Precinct'
'Franklin West Voting Precinct'
'Greene Voting Precinct'
'Jackson Voting Precinct'
'Jefferson #1 Voting Precinct'
'Jefferson #3 Voting Precinct'
'Monongahela #1 Voting Precinct'
'Monongahela #2 Voting Precinct'
'Morgan - Lippencott Voting Precinct'
'Morgan - Mather Voting Precinct'
'Morris Voting Precinct'
'Perry Voting Precinct'
'Rices Landing Borough Voting Precinct'
'Richhill Voting Precinct'
'Washington Voting Precinct'
'Wayne - East Voting Precinct'
'Wayne - West Voting Precinct'
'Waynesburg #1 Voting Precinct'
'Waynesburg #3 Voting Precinct'
'Whiteley Voting Precinct'
'Heidelberg'
'Lower Milford'
'Lowhill'
'Lynn Jacksonville District'
'Lynn Lynnville District'
'Lynn New Tripoli District'
'North Whitehall 1st District'
'North Whitehall 2nd District'
'North Whitehall 3rd District'
'North Whitehall 4th District'
'North Whitehall 5th District'
'North Whitehall 6th District'
'Slatington 1st District'
'Slatington 2nd District'
'Slatington 3rd District'
'Upper Milford Eastern District'
'Upper Milford Western District'
'Upper Saucon 2nd District'
'Upper Saucon 4th District'
'Washington Eastern District'
'Washington Southern District'
'Washington Western District'
'Weisenberg'
'Whitehall 10th District'
'Whitehall 11th District'
'Whitehall 7th District'
'Whitehall 8th District'
'Douglass 1'
'Douglass 2'
'Douglass 3'
'Douglass 4'
'Franconia 1'
'Franconia 3'
'Franconia 4'
'Franconia 5'
'Franconia 6'
'Limerick 5'
'Lower Frederick 2'
'Lower Moreland 4-1'
'Lower Salford 5'
'Marlborough'
'New Hanover 1'
'New Hanover 2'
'New Hanover 3'
'Pennsburg'
'Salford'
'Upper Frederick'
'Upper Hanover 1'
'Upper Hanover 2'
'Upper Hanover 3'
'Upper Salford'
'Worcester East 3'
'26-01'
'26-02'
'26-03'
'26-04'
'26-05'
'26-06'
'26-07'
'26-09'
'39-36'
'39-41'
'45-01'
'45-03'
'45-04'
'45-05'
'45-20'
'45-23'
'45-25'
'57-13'
'57-14'
'57-17'
'58-04'
'58-21'
'58-33'
'58-35'
'58-39'
'58-41'
'63-03'
'63-17'
'65-01'
'65-02'
'65-07'
'66-06'
'66-09'
'66-14'
'66-29'
'66-34'
'66-36'
'66-43'
'66-45'
'Amwell 1 Voting Precinct'
'Amwell 2 Voting Precinct'
'Bentleyville Voting Precinct'
'Blaine Voting Precinct'
'Buffalo Voting Precinct'
'Burgettstown Voting Precinct'
'California 3 Voting Precinct'
'Canonsburg 1-4 Voting Precinct'
'Canton 1 Voting Precinct'
'Canton 2 Voting Precinct'
'Canton 4 Voting Precinct'
'Canton 5 Voting Precinct'
'Carroll 2 Voting Precinct'
'Carroll 4 Voting Precinct'
'Carroll 5 Voting Precinct'
'Cecil 1 Voting Precinct'
'Cecil 2 Voting Precinct'
'Cecil 3 Voting Precinct'
'Cecil 4 Voting Precinct'
'Cecil 5 Voting Precinct'
'Cecil 6 Voting Precinct'
'Cecil 7 Voting Precinct'
'Centerville 1 Voting Precinct'
'Chartiers 1 Voting Precinct'
'Chartiers 3 Voting Precinct'
'Chartiers 5 Voting Precinct'
'Chartiers 6 Voting Precinct'
'Chartiers 7 Voting Precinct'
'Claysville Voting Precinct'
'Cross Creek 3 Voting Precinct'
'Deemston Voting Precinct'
'Donegal 1 Voting Precinct'
'Donegal 2 Voting Precinct'
'East Bethlehem 2 Voting Precinct'
'East Finley Voting Precinct'
'Fallowfield 1 Voting Precinct'
'Fallowfield 2 Voting Precinct'
'Fallowfield 3 Voting Precinct'
'Fallowfield 4 Voting Precinct'
'Hanover 1 Voting Precinct'
'Hanover 2 Voting Precinct'
'Hopewell Voting Precinct'
'Houston Voting Precinct'
'Independence 1 Voting Precinct'
'Independence 2 Voting Precinct'
'Jefferson Voting Precinct'
'Mcdonald Voting Precinct'
'Midway Voting Precinct'
'Monongahela 1w Voting Precinct'
'Mt Pleasant 1 Voting Precinct'
'Mt Pleasant 2 Voting Precinct'
'New Eagle 1 Voting Precinct'
'New Eagle 2 Voting Precinct'
'North Bethlehem Voting Precinct'
'North Franklin 1 Voting Precinct'
'North Franklin 2 Voting Precinct'
'North Franklin 3 Voting Precinct'
'North Strabane 1 Voting Precinct'
'North Strabane 2 Voting Precinct'
'North Strabane 3 Voting Precinct'
'North Strabane 4 Voting Precinct'
'North Strabane 5 Voting Precinct'
'North Strabane 7 Voting Precinct'
'North Strabane 8 Voting Precinct'
'North Strabane 9 Voting Precinct'
'Nottingham 1 Voting Precinct'
'Nottingham 2 Voting Precinct'
'Peters A-2 Voting Precinct'
'Peters A-3 Voting Precinct'
'Peters B-1 Voting Precinct'
'Peters B-2 Voting Precinct'
'Peters B-3 Voting Precinct'
'Peters C-1 Voting Precinct'
'Peters C-2 Voting Precinct'
'Peters C-3 Voting Precinct'
'Peters D-1 Voting Precinct'
'Peters D-2 Voting Precinct'
'Peters D-3 Voting Precinct'
'Robinson 1 Voting Precinct'
'Robinson 3 Voting Precinct'
'Smith 2 Voting Precinct'
'Smith 3 Voting Precinct'
'Somerset 1 Voting Precinct'
'Somerset 2 Voting Precinct'
'South Franklin 1 Voting Precinct'
'South Franklin 2 Voting Precinct'
'South Strabane 1 Voting Precinct'
'South Strabane 2 Voting Precinct'
'South Strabane 3 Voting Precinct'
'South Strabane 4 Voting Precinct'
'South Strabane 5 Voting Precinct'
'South Strabane 6 Voting Precinct'
'Speers Voting Precinct'
'Union 1 Voting Precinct'
'Union 2 Voting Precinct'
'Union 4 Voting Precinct'
'Union 5 Voting Precinct'
'Union 6 Voting Precinct'
'West Bethlehem Voting Precinct'
'West Finley 1 Voting Precinct'
'West Finley 2 Voting Precinct'
'West Pike Run 1 Voting Precinct'


# 7. Has Trump ever led the total vote (for any of the timestamps)?  (Return "Yes he did on <timestamp>" or "No he never did".

Interpretation: Has Trump ever led the total vote for any of the timestamps from the beginning of the election to the end.

Select precinct, Timestamp, 
CASE  
	WHEN sum(Trump) > sum(Biden) THEN concat('Yes he did on ' , Timestamp) 
    ELSE 'No he never did'
    END AS Result
FROM Penna GROUP BY precinct, timestamp LIMIT 1;

'Adams Township - Dunlo Voting Precinct','2020-11-04 03:58:36','Yes he did on 2020-11-04 03:58:36'



 







